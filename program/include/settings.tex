\documentclass{book}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage{listings}
\lstset{
  language=VHDL,
  numbers=left,
  firstnumber=0,
  backgroundcolor=\color{gray!10},
  inputencoding=utf8,
  extendedchars=false,
  keepspaces=true
}

\usepackage{tikz}
\usetikzlibrary{arrows}

\makeatletter
\def\lst@PlaceNumber{\ifnum\value{lstnumber}=0\else
  \llap{\normalfont\lst@numberstyle{\thelstnumber}\kern\lst@numbersep}\fi}
\makeatother
